INSERT INTO TEMP2 (SELECT DISTINCT WORDS FROM TEMP);
DROP TABLE TEMP;
INSERT INTO WORDS_DICTIONARY (SELECT WORDS, INDEX_SEQ.NEXTVAL FROM TEMP2);
DROP TABLE TEMP2;
INSERT INTO ADVERTISERS_INDEX(SELECT ADVERTISERID,INDEX_NUMBER, 1 FROM KEYWORDS, WORDS_DICTIONARY WHERE WORDS = KEYWORD GROUP BY ADVERTISERID, INDEX_NUMBER);
CREATE UNIQUE INDEX KEYWORDS_ADID ON KEYWORDS (KEYWORD, ADVERTISERID) PCTFREE 10 INITRANS 2 MAXTRANS 255 NOLOGGING COMPUTE STATISTICS  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645 PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT) TABLESPACE CISETS;
CREATE UNIQUE INDEX QID_QUERY ON QUERIES (QID, QUERY)  PCTFREE 10 INITRANS 2 MAXTRANS 255 NOLOGGING COMPUTE STATISTICS  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645 PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT) TABLESPACE CISETS ;
  CREATE BITMAP INDEX WORDS_INDEX_NUM ON WORDS_DICTIONARY (WORDS, INDEX_NUMBER)  PCTFREE 10 INITRANS 2 MAXTRANS 255 NOLOGGING COMPUTE STATISTICS  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT) TABLESPACE CISETS ;
COMMIT;
EXIT; 